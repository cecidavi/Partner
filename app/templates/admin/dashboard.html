<!-- templates/admin/dashboard.html -->
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Dashboard ‚Äì Admin PARNET</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/admin.css') }}">
</head>
<body>
  <div class="admin-container">
    <!-- Header -->
    <header class="admin-header">
      <h1>Dashboard de M√©tricas</h1>
      <nav>
        <a href="{{ url_for('admin.admin_home') }}">‚¨Ö Volver al panel</a>
        <a href="{{ url_for('auth.logout') }}">üîí Cerrar Sesi√≥n</a>
      </nav>
    </header>

    <!-- Main -->
    <main class="admin-main">
      <section>
        <p>En este panel encontrar√°s un resumen de solicitudes por √°rea y del cat√°logo de productos.</p>
      </section>

      <section>
        <div class="charts-wrapper" style="display:flex;flex-wrap:wrap;gap:2rem;">
          <div class="chart-card" style="flex:1;min-width:300px;">
            <h2>Solicitudes por √Årea</h2>
            <canvas id="servicesChart"></canvas>
          </div>
          <div class="chart-card" style="flex:1;min-width:300px;">
            <h2>Productos por Estatus</h2>
            <canvas id="productsChart"></canvas>
          </div>
        </div>
      </section>
    </main>
  </div>

  <!-- Chart.js desde CDN -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    // Datos inyectados desde Flask
    const serviceLabels = {{ service_stats|map(attribute=0)|list|tojson }};
    const serviceData   = {{ service_stats|map(attribute=1)|list|tojson }};
    const productLabels = {{ product_stats|map(attribute=0)|list|tojson }};
    const productData   = {{ product_stats|map(attribute=1)|list|tojson }};

    // Gr√°fico de barras: solicitudes por √°rea
    new Chart(document.getElementById('servicesChart'), {
      type: 'bar',
      data: {
        labels: serviceLabels,
        datasets: [{
          label: 'N.¬∫ de Solicitudes',
          data: serviceData,
          borderWidth: 1
        }]
      },
      options: {
        responsive: true,
        scales: {
          y: { beginAtZero: true }
        }
      }
    });

    // Gr√°fico de pastel: productos por estatus
    new Chart(document.getElementById('productsChart'), {
      type: 'pie',
      data: {
        labels: productLabels,
        datasets: [{
          label: 'Productos',
          data: productData,
          borderWidth: 1
        }]
      },
      options: { responsive: true }
    });
  </script>
</body>
</html>
